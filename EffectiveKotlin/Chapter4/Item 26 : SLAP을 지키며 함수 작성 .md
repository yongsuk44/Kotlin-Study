# Item 26: 각 함수는 단일 추상화 수준으로 작성되어야 한다.

컴퓨터는 매우 복잡한 장치지만, 이 복잡성이 각기 다른 계층의 요소로 분리되어 있어 이것들을 개발자들이 다룰 수 있습니다.

프로그래머의 시각에서 가장 낮은 추상화 계층은 하드웨어입니다.
우리는 프로세서를 위한 코드를 작성하므로, 다음 계층은 프로세서 제어 명령입니다.
이러한 명령들은 가독성을 위해 어셈블리 언어로 표현되며, 1대1로 번역됩니다.

어셈블리 언어로 프로그래밍하는 것은 어렵기 때문에, 프로그래밍을 단순화하기 위해 컴파일러가 도입되었습니다.
컴파일러는 한 언어를 다른 언어로 번역하는 프로그램입니다.
첫 번째 컴파일러는 어셈블리 언어로 작성되었으며, 이를 기반으로 첫 번째 고수준 언어들이 만들어졌습니다.
이 언어들은 C, C++ 등의 고수준 언어를 위한 컴파일러를 작성하는 데 사용되었습니다.

추상 머신과 해석 언어의 개념이 도입된 후에는 Java나 JavaScript와 같은 언어의 위치를 파악하기 어려워졌지만, 추상화 계층의 개념은 여전히 유지되었습니다.

잘 분리된 계층을 가짐으로써 얻는 큰 이점은 특정 계층에서 작업할 때 하위 계층이 예상대로 작동한다는 것에 의존할 수 있으므로, 세부 사항을 완전히 이해할 필요가 없다는 것입니다.
예를 들어, 우리는 어셈블러나 JVM 바이트코드에 대해 아무것도 알지 못하고도 프로그래밍을 할 수 있습니다.

## 추상화 레벨

컴퓨터 과학에서는 복잡성을 처리하기 위해 여러 계층을 쌓아가며 추상화를 진행하였습니다.
이 과정에서 '고수준'이라는 개념이 탄생했는데, 물리학에서 멀어질수록 또는 프로세싱에서 멀어질수록 '고수준'으로 분류됩니다.

더 고수준이라는 것은, 개발자들이 신경 써야 할 세부사항이 줄어든다는 것을 의미합니다.
그러나 이 간편함은 제어력을 상실하게 됨을 의미합니다.
예를 들어, C언어에서는 메모리 관리가 중요하지만, Java에서는 가비지 컬렉터가 이를 자동으로 처리해줍니다. 그 결과, 메모리 사용의 최적화는 더 어려워집니다.

## 단일 추상화 수준 원칙(Single Level of Abstraction Principle)

컴퓨터 과학에서 문제를 개별 계층으로 분리하듯이, 우리의 코드에서도 추상화를 수행할 수 있습니다.
이를 위해 가장 기본적인 도구로 함수를 사용합니다. 컴퓨터에서처럼, 한 번에 하나의 추상화 수준에서 작업하는 것이 바람직합니다.
이러한 이유로, 프로그래밍 커뮤니티는 "단일 추상화 수준" 원칙을 제정하였고, 이 원칙은 "각 함수는 단일 추상화 수준의 관점에서 작성되어야 한다"는 원칙을 명시하고 있습니다.

예를 들어, 커피를 만드는 복잡한 작업을 여러 개의 작은 함수로 분리하는 것이 이 원칙을 따르는 것입니다.
이렇게 하면 각 함수의 전반적인 흐름을 명확하게 이해할 수 있으며, 필요한 변경 사항이 발생하면 해당 위치로 직접 이동하여 수정할 수 있습니다.

```kotlin
class CoffeeMachine {
    fun makeCoffee() {
        grindCoffee()
        boilWater()
        brewCoffee()
    }
}
```

이 원칙에 따르면, 모든 새로운 함수는 간단하게 유지되어야 합니다. 일반적으로 함수는 작고 책임을 최소화하여야 합니다.
만약 어떤 함수가 복잡하다면, 중간 추상화를 추가로 추출해야 합니다. 결과적으로, 모두가 읽기 쉬운 작은 함수들을 얻을 수 있게 됩니다.

추가적으로, 이렇게 분리된 함수들은 재사용과 테스트가 더 쉽습니다. 더 작은 함수들을 개별적으로 단위 테스트할 수 있습니다.
이로써, 더 읽기 쉽고 이해하기 쉬운 코드를 얻을 수 있습니다. 이처럼 코드도 함수를 통해 추상화하여 작성할 수 있습니다.

## 추상화 계층과 프로그램 설계 (Abstraction levels in program architecture)

추상화 계층의 개념은 함수 이상의 더 높은 수준, 즉 시스템의 전체 설계에도 적용됩니다. 
이 과정에서는 하위 시스템의 세부 사항을 숨기고, 이를 통해 관심사의 분리를 통해 상호 운용성과 플랫폼 독립성을 증진합니다. 
이를 위해 개발자들은 문제 도메인에 특화된 언어, 즉 도메인 용어를 사용하여 고수준의 설계를 정의합니다. 
이렇게 하면 문제를 더욱 명확하게 이해할 수 있으며, 이는 결국 보다 효과적인 시스템 구현을 가능하게 합니다.

| 계층 | 레이어              |
|----|------------------|
| 4  | 고수준의 문제 도메인 용어   |
| 3  | 저수준의 문제 도메인 용어   |
| 2  | 저수준 구현 구조        |
| 1  | 프로그래밍 언어의 구조와 도구 |
| 0  | 운영체제 작업과 기계 명령   |

이러한 개념은 모듈화된 시스템을 설계할 때도 중요하며 모듈의 분리는 계층별 요소를 숨기는 데 효과적입니다.  
애플리케이션을 작성할 때, 입력이나 출력을 나타내는 모듈(View 또는 HTTP 요청 처리)은 하위 계층의 모듈로 간주됩니다.
반면에, 'UseCase' 또는 '비즈니스 로직'을 나타내는 모듈은 상위 계층의 레이어로 볼 수 있습니다.

계층이 잘 구분된 프로젝트는 "층화되었다"라고 표현합니다.
잘 층화된 프로젝트에서는 시스템을 어느 계층에서든 관찰하고 일관된 뷰를 얻을 수 있습니다.